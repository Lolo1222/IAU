This code was copied from https://github.com/spring-epfl/mia. But I came across several problems with original code. So I do some changes to make it work.